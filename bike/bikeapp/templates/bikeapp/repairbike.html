<!DOCTYPE html>
<html>
  <head>
    <title>show all bikes</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
    <style type="text/css">
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 60%;
      }

      /* Optional: Makes the sample page fill the window. */
      html,
      body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      der-color: #999999;
     }
    </style>
    <script>
          function initialize() {
          <!--pass values from web-end-->
          var bikeGPS = {{ bikeGPS|safe }};
          var bikesinfo = {{bikesinfo|safe }}

          <!--judge bikes' status and usage-->
          var i;
          for (i=0;i<bikesinfo.length;i++){
              if (bikesinfo[i][1] == '2'){
              bikesinfo[i][1] ='good to use'
              } else if(bikesinfo[i][1] == '0'){
              bikesinfo[i][1] ='broke down'
              }else if(bikesinfo[i][1] == '1'){
              bikesinfo[i][1] ='repairing'
              }

              if(bikesinfo[i][4] == '0'){
              bikesinfo[i][4] ='unoccupied'
              }else{
              bikesinfo[i][4] ='occupied'
              }
          }

          <!--show the google map-->
          var map = new google.maps.Map(document.getElementById('map'), {
           <!--zoom缩放，越大越精细-->
              zoom: 16,
              center: new google.maps.LatLng(55.87189, -4.28922),
              mapTypeId: google.maps.MapTypeId.ROADMAP
           });

            <!--draw bikes‘ location-->
           var infowindow = new google.maps.InfoWindow();
           var marker0, marker1, marker2, marker3, i, content_title;
           for (i = 0; i < bikeGPS.length; i++) {

               if(bikesinfo[i][1] == 'good to use' && bikesinfo[i][4] == 'unoccupied'){
                   marker0 = new google.maps.Marker({
                position: new google.maps.LatLng(bikeGPS[i][0], bikeGPS[i][1]),
                map: map,
                icon: {
                   url: "http://maps.google.com/mapfiles/ms/micons/green-dot.png"}
              });
                content_title = ['bike ID: ', 'bike status: ', 'bike area: ', 'bike password: ', 'bike usage: ']
                 bindInfoWindow(marker0, map, infowindow, "<p>" + content_title[0] + bikesinfo[i][0] + "</p>"
                         + "<p>" + content_title[1] + bikesinfo[i][1] + "</p>"
                         + "<p>" + content_title[2] + bikesinfo[i][2] + "</p>"
                         + "<p>" + content_title[3] + bikesinfo[i][3] + "</p>"
                         + "<p>" + content_title[4] + bikesinfo[i][4] + "</p>"
                 );
                 }

               else if(bikesinfo[i][1] == 'good to use' && bikesinfo[i][4] =='occupied'){
                  marker1 = new google.maps.Marker({
                position: new google.maps.LatLng(bikeGPS[i][0], bikeGPS[i][1]),
                map: map,
                icon: {
                   url: "http://maps.google.com/mapfiles/ms/micons/yellow-dot.png"}
              });
                 content_title = ['bike ID: ', 'bike status: ', 'bike area: ', 'bike password: ', 'bike usage: ']
                 bindInfoWindow(marker1, map, infowindow, "<p>" + content_title[0] + bikesinfo[i][0] + "</p>"
                         + "<p>" + content_title[1] + bikesinfo[i][1] + "</p>"
                         + "<p>" + content_title[2] + bikesinfo[i][2] + "</p>"
                         + "<p>" + content_title[3] + bikesinfo[i][3] + "</p>"
                         + "<p>" + content_title[4] + bikesinfo[i][4] + "</p>"
                 );
                 }

               else if(bikesinfo[i][1] == 'repairing'){
                   marker2 = new google.maps.Marker({
                position: new google.maps.LatLng(bikeGPS[i][0], bikeGPS[i][1]),
                map: map,
                icon: {
                   url: "http://maps.google.com/mapfiles/ms/micons/flag.png"}
              });
                content_title = ['bike ID: ', 'bike status: ', 'bike area: ', 'bike password: ', 'bike usage: ']
                 bindInfoWindow(marker2, map, infowindow, "<p>" + content_title[0] + bikesinfo[i][0] + "</p>"
                         + "<p>" + content_title[1] + bikesinfo[i][1] + "</p>"
                         + "<p>" + content_title[2] + bikesinfo[i][2] + "</p>"
                         + "<p>" + content_title[3] + bikesinfo[i][3] + "</p>"
                         + "<p>" + content_title[4] + bikesinfo[i][4] + "</p>"
                 );
                 }

               else{
                   marker3 = new google.maps.Marker({
                     position: new google.maps.LatLng(bikeGPS[i][0], bikeGPS[i][1]),
                     map: map,
                     icon: {
                         url: "http://maps.google.com/mapfiles/ms/micons/caution.png"
                     }
                 });
                   content_title = ['bike ID: ', 'bike status: ', 'bike area: ', 'bike password: ', 'bike usage: ']
                 bindInfoWindow(marker3, map, infowindow, "<p>" + content_title[0] + bikesinfo[i][0] + "</p>"
                         + "<p>" + content_title[1] + bikesinfo[i][1] + "</p>"
                         + "<p>" + content_title[2] + bikesinfo[i][2] + "</p>"
                         + "<p>" + content_title[3] + bikesinfo[i][3] + "</p>"
                         + "<p>" + content_title[4] + bikesinfo[i][4] + "</p>"
                 );
                 }

           }

    }

            <!--listener mouse-->
            function bindInfoWindow(marker, map, infowindow, html) {
            google.maps.event.addListener(marker, 'mouseover', function() {
               infowindow.setContent(html);
                infowindow.open(map, marker);
            });
            google.maps.event.addListener(marker, 'mouseout', function() {
                infowindow.close();
            });
}

          <!--load the map-->
          function loadScript() {
            var script = document.createElement('script');
            script.type = 'text/javascript';
            script.src = 'https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&' + 'callback=initialize';
            document.body.appendChild(script);
          }

          window.onload = loadScript;

        </script>
  </head>
  <body>
    <div id="map"></div>
    <!-- Async script executes immediately and must be after any DOM elements used in callback. -->
    <style type="text/css">
    #select_move{
        position: absolute;


    }
    <!------------table style------------->
          table.littletable {
        font-family: verdana,arial,sans-serif;
         font-size:11px;
         color:#333333;
         border-width: 1px;
         border-color: #999999;
         border-collapse: collapse;
     }
    table.littletable th {
         background:#4B71D8;
         border-width: 3px;
         padding: 10px;
         border-style: solid;
         border-color: #999999;
     }
    table.littletable td {
         background:#F5F5F5;
         border-width: 2px;
         padding: 8px;
         border-style: solid;
         border-color: #999999;
     }
</style>
    <script type="text/javascript">
function toggle(id){
var tb=document.getElementById(id);
if(tb.style.display=='none') tb.style.display='block';
else tb.style.display='none';
}
</script>


    <td>You have  </td>
    {% for i in number %}
    <td><font size="3" color="red">{{i}}</font></td>
    {% endfor %}
    <td> to reapir!!!</td>
<button type="button" value="show/hide" onclick="toggle('table1')">show/hide</button>

    <form action="repair" method="POST">
    <table class="littletable" id="table1"  style="display:none;" align="center">
        <thead>
            <tr bgcolor="#ff7f50">
                <th>bid needs to repair</th>
                <th>bid status</th>
                <th>bike area</th>
                <th>bike problem</th>
            </tr>
        </thead>
        <tbody align="center">
        {% for i in repair %}
             <tr>
                <td><input name="select_bid" type="checkbox" value="{{i.bID}}">{{i.bID}}</td>
                 <td>{{i.bstatus}}</td>
                 <td>{{i.barea}}</td>
                 <td>{{i.bproblem}}</td>
            </tr>
        {% endfor %}
        <td>
            <input type="submit" name="repair_bike" value="repair" >
        </td>
        </tbody>
    </table>
    </form>

<button type="button" value="show/hide" style="display:none;" onclick="toggle('table1')">repair!</button>
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD3vT3UOTtr5GYl6yqo3wLfmaiElz66hIw&callback=initMap&libraries=&v=weekly"
      async
    ></script>
  </body>
</html>
